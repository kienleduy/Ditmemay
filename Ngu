local OrionLib = loadstring(game:HttpGet(('https://raw.githubusercontent.com/jensonhirst/Orion/main/source')))()
local Window = OrionLib:MakeWindow({
    Name = "ALL-IN-ONE MENU ðŸ‘º",
    HidePremium = true,
    SaveConfig = false,
    IntroEnabled = false
})

local MainTab = Window:MakeTab({Name = "Main"})
local QuestTab = Window:MakeTab({Name = "Auto Quest"})
local SkillTab = Window:MakeTab({Name = "Auto Skill"})
local FruitTab = Window:MakeTab({Name = "Fruit"})
local RandomTab = Window:MakeTab({Name = "Random & Lucky"})
local MiscTab = Window:MakeTab({Name = "Misc"})

local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer

local function safe(func)
    pcall(func)
end

-- [KILL AURA - giá»¯ nguyÃªn]
local killAuraEnabled = false
local selectedTargetName = "ChÆ°a chá»n"
local targetList = {"ChÆ°a chá»n", "Siu_Owner"}
local dropdown

local function refreshTargetList()
    targetList = {"ChÆ°a chá»n", "Siu_Owner"}
    local npcFolder = workspace:FindFirstChild("NPC DAMAGE")
    if npcFolder then
        for _, model in ipairs(npcFolder:GetChildren()) do
            if model:IsA("Model") and model:FindFirstChildWhichIsA("Humanoid") then
                if model.Name ~= "Siu_Owner" then 
                    table.insert(targetList, model.Name) 
                end
            end
        end
    end
    if dropdown then dropdown:Refresh(targetList, true) end
end

local function killTarget(model)
    if not model then return end
    local hum = model:FindFirstChildWhichIsA("Humanoid")
    if hum and hum.Health > 0 then
        task.spawn(function()
            for i = 1, 25 do
                if hum.Health <= 0 then break end
                safe(function()
                    hum.Health = 0
                    hum.MaxHealth = 0
                    hum.Health = -math.huge
                    hum:TakeDamage(9e9)
                    hum:ChangeState(Enum.HumanoidStateType.Dead)
                end)
                task.wait()
            end
        end)
    end
end

MainTab:AddToggle({
    Name = "KÃ­ch hoáº¡t Kill Aura (Siu & NPC - Kill tá»« xa)",
    Default = false,
    Callback = function(state)
        killAuraEnabled = state
        if killAuraEnabled then
            OrionLib:MakeNotification({Name = "KILL AURA", Content = "Báº¬T - Kill tá»« xa: " .. selectedTargetName, Time = 5})
            task.spawn(function()
                while killAuraEnabled do
                    task.wait(0.08)
                    safe(function()
                        sethiddenproperty(LocalPlayer, "SimulationRadius", 1e12)
                        sethiddenproperty(LocalPlayer, "MaxSimulationRadius", 1e12)
                    end)
                    
                    if selectedTargetName == "Siu_Owner" then
                        local boss = workspace:FindFirstChild("Siu_Owner")
                        if boss then killTarget(boss) end
                    else
                        local npcFolder = workspace:FindFirstChild("NPC DAMAGE")
                        if npcFolder then
                            local target = npcFolder:FindFirstChild(selectedTargetName)
                            if target then killTarget(target) end
                        end
                    end
                end
            end)
        else
            OrionLib:MakeNotification({Name = "KILL AURA", Content = "Táº®T", Time = 3})
        end
    end    
})

dropdown = MainTab:AddDropdown({
    Name = "Chá»n má»¥c tiÃªu",
    Default = "ChÆ°a chá»n",
    Options = targetList,
    Callback = function(v)
        selectedTargetName = v
        OrionLib:MakeNotification({Name = "ÄÃ£ chá»n", Content = "Má»¥c tiÃªu: " .. v, Time = 4})
    end
})

MainTab:AddButton({Name = "LÃ m má»›i danh sÃ¡ch quÃ¡i", Callback = function() refreshTargetList() end})

-- [AUTO QUEST - Dropdown quÃ©t NPCS + fire Accept1 tá»« NPC chá»n]
local autoQuestNPCEnabled = false
local selectedQuestNPC = "ChÆ°a chá»n"
local questNPCList = {"ChÆ°a chá»n"}
local questDropdown

local function refreshQuestNPCList()
    questNPCList = {"ChÆ°a chá»n"}
    
    safe(function()
        local npcsFolder = workspace:FindFirstChild("NPCS")
        if npcsFolder then
            for _, npc in ipairs(npcsFolder:GetChildren()) do
                if npc:IsA("Model") and npc:FindFirstChild("ClickPart") then
                    table.insert(questNPCList, npc.Name)
                end
            end
        end
    end)
    
    if questDropdown then questDropdown:Refresh(questNPCList, true) end
    
    OrionLib:MakeNotification({
        Name = "Refresh NPC",
        Content = "ÄÃ£ quÃ©t: " .. (#questNPCList - 1) .. " NPC Quest Giver",
        Time = 4
    })
end

QuestTab:AddToggle({
    Name = "Auto Nháº­n Quest tá»« NPC chá»n (Accept1)",
    Default = false,
    Callback = function(state)
        autoQuestNPCEnabled = state
        
        if autoQuestNPCEnabled then
            if selectedQuestNPC == "ChÆ°a chá»n" then
                OrionLib:MakeNotification({Name = "Cáº£nh bÃ¡o", Content = "ChÆ°a chá»n NPC!", Time = 5})
                autoQuestNPCEnabled = false
                return
            end
            
            OrionLib:MakeNotification({
                Name = "AUTO QUEST NPC",
                Content = "Báº¬T - Auto fire Accept1 tá»«: " .. selectedQuestNPC,
                Time = 5
            })
            
            task.spawn(function()
                while autoQuestNPCEnabled do
                    task.wait(0.8)
                    
                    safe(function()
                        local npc = workspace.NPCS:FindFirstChild(selectedQuestNPC)
                        if npc and npc:FindFirstChild("ClickPart") then
                            local questTakeFolder = npc.ClickPart:FindFirstChild("QuestTake")
                            if questTakeFolder then
                                local questTakeInner = questTakeFolder:FindFirstChild("QuestTake")
                                if questTakeInner then
                                    local accept1 = questTakeInner:FindFirstChild("Accept1")
                                    if accept1 then
                                        local remote = accept1:FindFirstChildOfClass("RemoteEvent")
                                        if remote then remote:FireServer() end
                                    end
                                end
                            end
                        end
                    end)
                end
            end)
        else
            OrionLib:MakeNotification({Name = "AUTO QUEST NPC", Content = "Táº®T", Time = 3})
        end
    end    
})

questDropdown = QuestTab:AddDropdown({
    Name = "Chá»n NPC Quest Giver",
    Default = "ChÆ°a chá»n",
    Options = questNPCList,
    Callback = function(value)
        selectedQuestNPC = value
        OrionLib:MakeNotification({Name = "ÄÃ£ chá»n", Content = "NPC: " .. value, Time = 4})
    end    
})

QuestTab:AddButton({
    Name = "LÃ m má»›i danh sÃ¡ch NPC",
    Callback = function() refreshQuestNPCList() end    
})

-- [AUTO SKILL giá»¯ nguyÃªn]
local function makeSkillToggle(tab, key)
    tab:AddToggle({
        Name = "Auto Skill " .. key,
        Default = false,
        Callback = function(state)
            getgenv()["autoskill" .. key:lower()] = state
            task.spawn(function()
                while getgenv()["autoskill" .. key:lower()] do
                    task.wait()
                    safe(function()
                        for _, tool in pairs(LocalPlayer.Character:GetChildren()) do
                            if tool:IsA("Tool") then
                                local skill = tool:FindFirstChild(key)
                                if skill then
                                    for _, remote in pairs(skill:GetChildren()) do
                                        if remote:IsA("RemoteEvent") then
                                            remote:FireServer()
                                        end
                                    end
                                end
                            end
                        end
                    end)
                end
            end)
        end
    })
end

for _, key in ipairs({"Z","X","C","V","B","N"}) do
    makeSkillToggle(SkillTab, key)
end

-- [FRUIT giá»¯ nguyÃªn]
FruitTab:AddButton({
    Name = "STORE AND EAT (4 GUI) ðŸ‘º",
    Callback = function()
        safe(function()
            local Save = game:GetService("ReplicatedStorage"):WaitForChild("Save")
            local Tool = LocalPlayer.Character:FindFirstChildOfClass("Tool")
            Save:WaitForChild("SavingMelee"):FireServer(-5)
            Save:WaitForChild("SavingSword"):FireServer(-5)
            if Tool and Tool.Name:lower():find("fruit") then 
                Save:WaitForChild("SavingEvent"):FireServer(1) 
            end
            task.wait(0.2)
            for _, Name in pairs({"BOXGUI", "ArmorBox", "DFGUI", "BOOKGUI"}) do
                local Gui = LocalPlayer.PlayerGui:FindFirstChild(Name)
                if Gui and Gui:FindFirstChild("Frame") and Gui.Frame:FindFirstChild("Sure") then
                    if Gui.Frame.Sure:FindFirstChild("EatScript") then 
                        Gui.Frame.Sure.EatScript.Eat:FireServer() 
                    end
                end
            end
        end)
    end
})

-- [LUCKY SPIN giá»¯ nguyÃªn]
local rollAmount = 1
RandomTab:AddTextbox({
    Name = "Sá»‘ lÆ°á»£ng roll",
    Default = "1",
    Callback = function(v) rollAmount = tonumber(v) or 1 end
})
RandomTab:AddButton({
    Name = "Lucky Spin ðŸ‘º",
    Callback = function()
        safe(function()
            local args = { { true, { Legendary = false, Common = false, Rare = false, Mythical = false, Secret = false }, rollAmount } }
            LocalPlayer.PlayerGui.Random.Bright:FireServer(unpack(args))
        end)
    end
})

-- [AUTO NHáº¶T - KHÃ”NG QUÃ‰T MAP & NPCS]
MiscTab:AddToggle({
    Name = "Auto Nháº·t Item 100k Stud (0.3s) - TrÃ¡nh MAP & NPCS",
    Default = false,
    Callback = function(state)
        getgenv().AutoCollectItems = state
        task.spawn(function()
            while getgenv().AutoCollectItems do
                safe(function()
                    local hrp = LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
                    if not hrp then return end
                    
                    -- QuÃ©t GetChildren, skip MAP & NPCS
                    for _, obj in pairs(workspace:GetChildren()) do
                        if obj.Name == "MAP" or obj.Name == "NPCS" or obj.Name == "NPC DAMAGE" then
                            continue
                        end
                        
                        local cd = obj:FindFirstChildWhichIsA("ClickDetector", true)
                        if cd then
                            local parentPart = cd.Parent
                            if parentPart:IsA("BasePart") and (parentPart.Position - hrp.Position).Magnitude <= 100000 then
                                fireclickdetector(cd)
                            end
                        end
                        
                        local touch = obj:FindFirstChildWhichIsA("TouchInterest", true)
                        if touch then
                            local h = touch.Parent
                            if h:IsA("BasePart") and (h.Position - hrp.Position).Magnitude <= 100000 then
                                h.CFrame = hrp.CFrame
                            end
                        end
                    end
                    
                    -- QuÃ©t GetDescendants, skip náº¿u náº±m trong MAP/NPCS/NPC DAMAGE
                    for _, obj in pairs(workspace:GetDescendants()) do
                        if obj:IsDescendantOf(workspace.MAP) or obj:IsDescendantOf(workspace.NPCS) or obj:IsDescendantOf(workspace["NPC DAMAGE"]) then
                            continue
                        end
                        
                        local cd = obj:FindFirstChildWhichIsA("ClickDetector")
                        if cd then
                            local parentPart = cd.Parent
                            if parentPart:IsA("BasePart") and (parentPart.Position - hrp.Position).Magnitude <= 100000 then
                                fireclickdetector(cd)
                            end
                        end
                        
                        local touch = obj:FindFirstChildWhichIsA("TouchInterest")
                        if touch then
                            local h = touch.Parent
                            if h:IsA("BasePart") and (h.Position - hrp.Position).Magnitude <= 100000 then
                                h.CFrame = hrp.CFrame
                            end
                        end
                    end
                end)
                task.wait(0.3)
            end
        end)
    end
})

-- Load ban Ä‘áº§u
refreshTargetList()
refreshQuestNPCList()

print("Menu ALL-IN-ONE fixed! Auto Quest GUI bá», giá»¯ dropdown NPC, auto nháº·t trÃ¡nh MAP & NPCS.")
